import{_ as H,a as J}from"./BRlHJsEL.js";import K from"./DU8aUCDA.js";import{g as V,j as Q,e as X,k as Z,r as tt,l as x,m as et,o as l,w as st,a as s,c as i,n as c,b as I,F as j,p as A,q as B,t as m,s as E,v as F,x as ot,y as nt,z as L,A as P,B as at,_ as lt}from"./CFJHarlv.js";import{u as rt}from"./A9EJF33Q.js";const it="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let U=(d=21)=>{let u="",n=crypto.getRandomValues(new Uint8Array(d|=0));for(;d--;)u+=it[n[d]&63];return u};typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const W=()=>{};function ct(d,u){function n(...r){return new Promise((a,g)=>{Promise.resolve(d(()=>u.apply(this,r),{fn:u,thisArg:this,args:r})).then(a).catch(g)})}return n}function ut(d,u={}){let n,r,a=W;const g=v=>{clearTimeout(v),a(),a=W};let D;return v=>{const p=V(d),_=V(u.maxWait);return n&&g(n),p<=0||_!==void 0&&_<=0?(r&&(g(r),r=null),Promise.resolve(v())):new Promise((h,y)=>{a=u.rejectOnCancel?y:h,D=v,_&&!r&&(r=setTimeout(()=>{n&&g(n),r=null,h(D())},_)),n=setTimeout(()=>{r&&g(r),r=null,h(v())},p)})}}function dt(d,u=200,n={}){return ct(ut(u,n),d)}const xt={key:0},ft={class:"flex h-screen overflow-x-hidden"},mt={class:"grow-0 shrink-0 p-8 w-[320px] bg-zinc-900 text-white overflow-y-auto"},gt={key:0,class:"mb-8"},_t=["onClick"],pt={class:"font-extrabold capitalize text-lg"},ht={class:"flex items-center gap-2"},vt={class:"text-xs font-light text-gray-200"},yt={class:"text-xs"},bt={key:1,class:"mb-8 text-xs font-light text-gray-200 text-center"},wt={key:0,class:"mb-8"},Dt=["onClick"],Nt={class:"font-extrabold capitalize text-lg"},kt={class:"flex items-center gap-2"},St={class:"text-xs font-light text-gray-200"},Tt={class:"text-xs"},Ct={key:1,class:"mb-8 text-xs font-light text-gray-200 text-center"},zt={key:0,class:"mb-8"},$t=["onClick"],It={class:"font-extrabold capitalize text-lg"},jt={class:"flex items-center gap-2"},At={class:"text-xs font-light text-gray-200"},Bt={class:"text-xs"},Lt={key:1,class:"mb-8 text-xs font-light text-gray-200 text-center"},Ot={class:"col-span-7 bg-zinc-800 w-full relative"},Rt={class:"flex justify-between w-full absolute top-4 px-4"},Vt={key:0,class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[50%]"},Et={class:"flex flex-col gap-2 @submit.prevent"},Ft={key:1,class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[50%]"},Pt={key:1,class:"h-screen flex items-center justify-center text-white"},Ut=Q({__name:"index",setup(d){const{$firebase:u}=X(),n=Z(),r=rt(),a=tt({id:"",created:new Date,title:"",text:""}),g=async()=>{try{await ot(u.auth),n.logout(),nt({path:"/login"})}catch(t){console.error("Sign-out failed:",t)}},D=async()=>{if(!n.user)return;const t=U(10),e={id:t,text:"",title:"",created:new Date().toISOString(),lastEdited:null};r.addNote(n.user.uid,e);const f=L(u.db,`notes/${n.user.uid}/${t}`);a.value=e,await P(f,e)},O=async()=>{if(!n.user)return;r.removeNote(n.user.uid,a.value.id);const t=L(u.db,`notes/${n.user.uid}/${a.value.id}`);N.value&&w(N.value),await at(t),T.value.length===0&&C.value.length===0&&z.value.length===0&&(a.value={id:U(10),title:"",text:"",created:new Date().toISOString(),lastEdited:null})},p=dt(async()=>{if(!n.user)return;const t={...a.value,lastEdited:new Date().toDateString()},e=L(u.db,`notes/${n.user.uid}/${t.id}`);await P(e,t)},1e3),_=t=>x(()=>new Date(t.created).toLocaleDateString("en-US")),h=t=>t.text.length>15?t.text.slice(0,15)+"...":t.text,y=t=>t.title.length>15?t.title.slice(0,20)+"...":t.title,b=x(()=>{var t;return n.user?r.notes[(t=n.user)==null?void 0:t.uid]||[]:[]}),G=x(()=>b.value.length!==0),w=t=>{a.value!==t&&(a.value=t)},T=x(()=>{const t=new Date().toDateString();return b.value.filter(e=>new Date(e.created).toDateString()===t).sort((e,f)=>new Date(f.created).getTime()-new Date(e.created).getTime())}),Y=x(()=>T.value.length>0),C=x(()=>{const t=new Date;return t.setDate(t.getDate()-1),b.value.filter(e=>new Date(e.created).toDateString()===t.toDateString())}),q=x(()=>C.value.length>0),z=x(()=>{const t=new Date().toDateString(),e=new Date;e.setDate(e.getDate()-1);const f=e.toDateString();return b.value.filter(k=>{const S=new Date(k.created).toDateString();return S!==t&&S!==f})}),M=x(()=>z.value.length>0),$=t=>t.id===a.value.id,N=x(()=>{const t=b.value;return t.length?[...t].sort((e,f)=>new Date(f.created).getTime()-new Date(e.created).getTime())[0]:null});return N.value&&w(N.value),(t,e)=>{const f=H,k=K,S=J;return l(),et(S,null,{default:st(()=>[s("div",null,[c(n).authResolved?(l(),i("div",xt,[s("main",ft,[s("div",mt,[I(f,{class:"mb-16"}),s("div",null,[e[4]||(e[4]=s("h2",{class:"mb-4"},"Today",-1)),c(Y)?(l(),i("ul",gt,[(l(!0),i(j,null,A(c(T),o=>(l(),i("li",{key:o.id,class:"ml-4"},[s("button",{class:B(["p-4 flex flex-col justify-start items-start w-full",{selected:$(o)}]),onClick:R=>w(o)},[s("h3",pt,m(y(o)),1),s("div",ht,[s("span",vt,m(_(o)),1),s("span",yt,m(h(o)),1)])],10,_t)]))),128))])):(l(),i("div",bt," No Notes "))]),s("div",null,[e[5]||(e[5]=s("h2",{class:"mb-4"},"Yesterday",-1)),c(q)?(l(),i("ul",wt,[(l(!0),i(j,null,A(c(C),o=>(l(),i("li",{key:o.id,class:"ml-4"},[s("button",{class:B(["p-4 flex flex-col justify-start items-start w-full",{selected:$(o)}]),onClick:R=>w(o)},[s("h3",Nt,m(y(o)),1),s("div",kt,[s("span",St,m(_(o)),1),s("span",Tt,m(h(o)),1)])],10,Dt)]))),128))])):(l(),i("div",Ct," No Notes "))]),s("div",null,[e[6]||(e[6]=s("h2",{class:"mb-4"},"Prev 30 Days",-1)),c(M)?(l(),i("ul",zt,[(l(!0),i(j,null,A(c(z),o=>(l(),i("li",{key:o.id,class:"ml-4"},[s("button",{class:B(["p-4 flex flex-col justify-start items-start w-full",{selected:$(o)}]),onClick:R=>w(o)},[s("h3",It,m(y(o)),1),s("div",jt,[s("span",At,m(_(o)),1),s("span",Bt,m(h(o)),1)])],10,$t)]))),128))])):(l(),i("div",Lt," No Notes "))])]),s("div",Ot,[s("div",Rt,[s("button",{class:"flex items-center gap-2 hover:text-gray-300",onClick:D},[I(k,{name:"mingcute:edit-4-line",class:"size-6"}),e[7]||(e[7]=s("span",null,"Create Note",-1))]),s("button",{onClick:O},[I(k,{name:"material-symbols:delete-forever",class:"size-6 hover:text-gray-300"})])]),c(G)?(l(),i("div",Vt,[s("form",Et,[E(s("input",{id:"title","onUpdate:modelValue":e[0]||(e[0]=o=>c(a).title=o),type:"text",name:"title",class:"bg-zinc-800 p-2 p-2 hover:bg-zinc-700 rounded-lg",placeholder:"Title",onInput:e[1]||(e[1]=(...o)=>c(p)&&c(p)(...o))},null,544),[[F,c(a).title]]),E(s("textarea",{id:"text","onUpdate:modelValue":e[2]||(e[2]=o=>c(a).text=o),name:"text",class:"bg-zinc-800 resize-none p-2 hover:bg-zinc-700 rounded-lg",placeholder:"Body",rows:"12",onInput:e[3]||(e[3]=(...o)=>c(p)&&c(p)(...o))},null,544),[[F,c(a).text]])])])):(l(),i("div",Ft,e[8]||(e[8]=[s("p",{class:"text-center"},"Create a note to get started",-1)]))),s("button",{class:"absolute bottom-4 right-4",onClick:g}," Logout ")])])])):(l(),i("div",Pt," Loading... "))])]),_:1})}}}),Mt=lt(Ut,[["__scopeId","data-v-68b6896b"]]);export{Mt as default};
