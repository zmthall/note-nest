import{_ as X,a as Z}from"./BQDKeJ-3.js";import tt from"./C5YVw4IS.js";import{g as P,j as et,e as st,k as ot,r as U,l as x,m as nt,o as r,w as at,a as e,c,n as l,p as w,b as D,F as L,q as R,t as h,s as W,v as G,x as lt,y as rt,z as V,A as Y,B as it,_ as ct}from"./DkI0AXVV.js";import{u as ut}from"./BXZk_JrV.js";const dt="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let q=(m=21)=>{let u="",n=crypto.getRandomValues(new Uint8Array(m|=0));for(;m--;)u+=dt[n[m]&63];return u};typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const M=()=>{};function mt(m,u){function n(...i){return new Promise((d,a)=>{Promise.resolve(m(()=>u.apply(this,i),{fn:u,thisArg:this,args:i})).then(d).catch(a)})}return n}function xt(m,u={}){let n,i,d=M;const a=p=>{clearTimeout(p),d(),d=M};let N;return p=>{const k=P(m),g=P(u.maxWait);return n&&a(n),k<=0||g!==void 0&&g<=0?(i&&(a(i),i=null),Promise.resolve(p())):new Promise((S,v)=>{d=u.rejectOnCancel?v:S,N=p,g&&!i&&(i=setTimeout(()=>{n&&a(n),i=null,S(N())},g)),n=setTimeout(()=>{i&&a(i),i=null,S(p())},k)})}}function ft(m,u=200,n={}){return mt(xt(u,n),m)}const ht={key:0},pt={class:"flex h-dvh overflow-hidden"},gt={key:0,class:"mb-8"},vt=["onClick"],_t={class:"font-extrabold capitalize text-lg"},yt={class:"flex items-center gap-2"},bt={class:"text-xs font-light text-gray-200"},wt={class:"text-xs"},Dt={key:1,class:"mb-8 text-xs font-light text-gray-200 text-center"},Nt={key:0,class:"mb-8"},kt=["onClick"],St={class:"font-extrabold capitalize text-lg"},Ct={class:"flex items-center gap-2"},zt={class:"text-xs font-light text-gray-200"},Tt={class:"text-xs"},$t={key:1,class:"mb-8 text-xs font-light text-gray-200 text-center"},It={key:0,class:"mb-8"},jt=["onClick"],Ot={class:"font-extrabold capitalize text-lg"},At={class:"flex items-center gap-2"},Bt={class:"text-xs font-light text-gray-200"},Lt={class:"text-xs"},Rt={key:1,class:"mb-8 text-xs font-light text-gray-200 text-center"},Vt={class:"col-span-7 bg-zinc-800 w-full relative"},Et={class:"flex justify-between w-full absolute top-4 px-4"},Ft={key:0,class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[80%] sm:w-[50%]"},Pt={class:"flex flex-col gap-2 @submit.prevent"},Ut={key:1,class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[50%]"},Wt={key:1,class:"h-dvh flex items-center justify-center text-white"},Gt=et({__name:"index",setup(m){const{$firebase:u}=st(),n=ot(),i=ut(),d=U(!1),a=U({id:"",created:new Date,title:"",text:""}),N=async()=>{try{await lt(u.auth),n.logout(),rt({path:"/login"})}catch(t){console.error("Sign-out failed:",t)}},E=async()=>{if(!n.user)return;const t=q(10),s={id:t,text:"",title:"",created:new Date().toISOString(),lastEdited:null};i.addNote(n.user.uid,s);const f=V(u.db,`notes/${n.user.uid}/${t}`);a.value=s,await Y(f,s)},p=async()=>{if(!n.user)return;i.removeNote(n.user.uid,a.value.id);const t=V(u.db,`notes/${n.user.uid}/${a.value.id}`);C.value&&b(C.value),await it(t),j.value.length===0&&O.value.length===0&&A.value.length===0&&(a.value={id:q(10),title:"",text:"",created:new Date().toISOString(),lastEdited:null})},k=()=>{d.value=!0},g=()=>{d.value=!1},v=ft(async()=>{if(!n.user)return;const t={...a.value,lastEdited:new Date().toDateString()},s=V(u.db,`notes/${n.user.uid}/${t.id}`);await Y(s,t)},1e3),T=t=>x(()=>new Date(t.created).toLocaleDateString("en-US")),$=t=>t.text.length>15?t.text.slice(0,15)+"...":t.text,I=t=>t.title.length>15?t.title.slice(0,20)+"...":t.title,y=x(()=>{var t;return n.user?i.notes[(t=n.user)==null?void 0:t.uid]||[]:[]}),H=x(()=>y.value.length!==0),b=t=>{a.value!==t&&(a.value=t)},j=x(()=>{const t=new Date().toDateString();return y.value.filter(s=>new Date(s.created).toDateString()===t).sort((s,f)=>new Date(f.created).getTime()-new Date(s.created).getTime())}),J=x(()=>j.value.length>0),O=x(()=>{const t=new Date;return t.setDate(t.getDate()-1),y.value.filter(s=>new Date(s.created).toDateString()===t.toDateString())}),K=x(()=>O.value.length>0),A=x(()=>{const t=new Date().toDateString(),s=new Date;s.setDate(s.getDate()-1);const f=s.toDateString();return y.value.filter(_=>{const z=new Date(_.created).toDateString();return z!==t&&z!==f})}),Q=x(()=>A.value.length>0),B=t=>t.id===a.value.id,C=x(()=>{const t=y.value;return t.length?[...t].sort((s,f)=>new Date(f.created).getTime()-new Date(s.created).getTime())[0]:null});return C.value&&b(C.value),(t,s)=>{const f=X,_=tt,z=Z;return r(),nt(z,null,{default:at(()=>[e("div",null,[l(n).authResolved?(r(),c("div",ht,[e("main",pt,[e("div",{class:w([{"fixed w-full h-dvh backdrop-blur-sm z-[1]":l(d)},"sm:hidden"]),onClick:g},null,2),e("div",{class:w(["grow-0 shrink-0 p-8 w-[320px] bg-zinc-900 text-white overflow-y-auto max-sm:absolute max-sm:top-0 max-smleft-0 max-sm:z-[2] max-sm:h-dvh transition-transform duration-500 ease-in-out",{"max-sm:translate-x-[-100%]":!l(d),"max-sm:translate-x-0":l(d)}])},[D(f,{class:"mb-16"}),e("button",{onClick:g},[D(_,{name:"material-symbols:close-rounded",class:"size-8 absolute top-4 right-4 hover:text-white text-gray-300"})]),e("div",null,[s[4]||(s[4]=e("h2",{class:"mb-4"},"Today",-1)),l(J)?(r(),c("ul",gt,[(r(!0),c(L,null,R(l(j),o=>(r(),c("li",{key:o.id,class:"ml-4"},[e("button",{class:w(["p-4 flex flex-col justify-start items-start w-full",{selected:B(o)}]),onClick:F=>b(o)},[e("h3",_t,h(I(o)),1),e("div",yt,[e("span",bt,h(T(o)),1),e("span",wt,h($(o)),1)])],10,vt)]))),128))])):(r(),c("div",Dt," No Notes "))]),e("div",null,[s[5]||(s[5]=e("h2",{class:"mb-4"},"Yesterday",-1)),l(K)?(r(),c("ul",Nt,[(r(!0),c(L,null,R(l(O),o=>(r(),c("li",{key:o.id,class:"ml-4"},[e("button",{class:w(["p-4 flex flex-col justify-start items-start w-full",{selected:B(o)}]),onClick:F=>b(o)},[e("h3",St,h(I(o)),1),e("div",Ct,[e("span",zt,h(T(o)),1),e("span",Tt,h($(o)),1)])],10,kt)]))),128))])):(r(),c("div",$t," No Notes "))]),e("div",null,[s[6]||(s[6]=e("h2",{class:"mb-4"},"Prev 30 Days",-1)),l(Q)?(r(),c("ul",It,[(r(!0),c(L,null,R(l(A),o=>(r(),c("li",{key:o.id,class:"ml-4"},[e("button",{class:w(["p-4 flex flex-col justify-start items-start w-full",{selected:B(o)}]),onClick:F=>b(o)},[e("h3",Ot,h(I(o)),1),e("div",At,[e("span",Bt,h(T(o)),1),e("span",Lt,h($(o)),1)])],10,jt)]))),128))])):(r(),c("div",Rt," No Notes "))])],2),e("div",Vt,[e("div",Et,[e("button",{class:"flex items-center gap-2 hover:text-gray-300",onClick:E},[D(_,{name:"mingcute:edit-4-line",class:"size-6"}),s[7]||(s[7]=e("span",null,"Create Note",-1))]),e("button",{onClick:p},[D(_,{name:"material-symbols:delete-forever",class:"size-6 hover:text-gray-300"})])]),e("button",{class:"absolute left-0 top-1/2 -translate-y-1/2 py-8 bg-zinc-700 cursor-pointer rounded-r-lg hover:bg-zinc-600 sm:hidden",onClick:k},[D(_,{name:"material-symbols:chevron-right-rounded",class:"size-6"})]),l(H)?(r(),c("div",Ft,[e("form",Pt,[W(e("input",{id:"title","onUpdate:modelValue":s[0]||(s[0]=o=>l(a).title=o),type:"text",name:"title",class:"bg-zinc-800 p-2 p-2 hover:bg-zinc-700 rounded-lg",placeholder:"Title",onInput:s[1]||(s[1]=(...o)=>l(v)&&l(v)(...o))},null,544),[[G,l(a).title]]),W(e("textarea",{id:"text","onUpdate:modelValue":s[2]||(s[2]=o=>l(a).text=o),name:"text",class:"bg-zinc-800 resize-none p-2 hover:bg-zinc-700 rounded-lg",placeholder:"Body",rows:"12",onInput:s[3]||(s[3]=(...o)=>l(v)&&l(v)(...o))},null,544),[[G,l(a).text]])])])):(r(),c("div",Ut,s[8]||(s[8]=[e("p",{class:"text-center"},"Create a note to get started",-1)]))),e("button",{class:"absolute bottom-4 right-4",onClick:N}," Logout ")])])])):(r(),c("div",Wt," Loading... "))])]),_:1})}}}),Jt=ct(Gt,[["__scopeId","data-v-0771b794"]]);export{Jt as default};
